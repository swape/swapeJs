"use strict";var sjs=function(){function e(e,t){for(var n=[],r=0;e.length>r;r++)e[r]!==t&&n.push(e[r]);return n}function t(t){return t&&"undefined"!=typeof t&&(t.setStyle=function(e,n){if("undefined"!=typeof t.length)for(var r=0;t.length>r;r++)t[r].style[e]=n;else t.style[e]=n;return t},t.setClass=function(e){if("undefined"!=typeof t.length)for(var n=0;t.length>n;n++)t[n].className=e;else t.className=e;return t},t.addClass=function(e){if("undefined"!=typeof t.length)for(var n=0;t.length>n;n++)t[n].className=t[n].className+" "+e;else t.className=t.className+" "+e;return t},t.removeClass=function(n){if("undefined"!=typeof t.length){for(var r=0;t.length>r;r++)if(t[r].classList.length>0){var o=e(t[r].classList,n);t[r].className=o.join(" ")}}else if(t.classList.length>0){var i=e(t.classList,n);t.className=i.join(" ")}return t}),t}var n={get:function(e,n){var r=e.trim().split(" ").length,o=e.charAt(0),i=null;return i="#"===o&&1===r?document.getElementById(e.replace("#","")):n?document.querySelectorAll(e):document.querySelector(e),i=t(i)},getAll:function(e){return n.get(e,!0)}},r={xhr:function(e,t,n,r){return new Promise(function(o,i){var a=new XMLHttpRequest;if(e=e.toUpperCase(),"POST"!==e){var u=[],l=void 0;if("undefined"!=typeof n&&null!==n){t=t.match(/\?/gim)?t+"&":t+"?";for(l in n)u.push(encodeURIComponent(l)+"="+encodeURIComponent(n[l]));t+=u.join("&")}}if(a.open(e,t),r&&"undefined"!=typeof r){var s="";for(s in r)a.setRequestHeader(s,r[s])}a.onload=function(){200===a.status?o(a.response):i(Error(a.statusText))},a.onerror=function(){i(Error("Network Error"))},"POST"===e?"undefined"!=typeof n&&null!==n&&a.send(JSON.stringify(n)):a.send()})},get:function(e,t,n){return r.xhr("GET",e,t,n)},post:function(e,t,n){return r.xhr("POST",e,t,n)}},o={_routes:[],_currentRoute:"",_defaultView:"",_config:{},_altView:"",add:function(e){return o._routes.push(e),o},init:function(e){return o._config=e,o._bindAllLinks(),o._getPath(),o._findRouteMatch(),o},_bindAllLinks:function(){o._bindLinks(n.get("a[sjs-link]:not(.sjs-bound)",!0))},_bindLink:function(e){if(e.preventDefault(),e.stopPropagation(),o._currentRoute!==e.target.pathname){var t=e.target.innerText.trim().replace(/ /gi,"_");o._config&&"undefined"!=typeof o._config.mode&&"history"===o._config.mode?window.history.pushState(null,t,e.target.pathname):location.hash=e.target.pathname,o._getPath(),o._altView=e.target.getAttribute("sjs-link"),o._findRouteMatch(),o._makeActiveLink(e)}},_makeActiveLink:function(e){n.get("a[sjs-link]",!0).removeClass("active"),e.target.className=e.target.className+" active"},_bindLinks:function(e){if(e&&e.length>0)for(var t=0;e.length>t;t++)e[t].addEventListener("click",o._bindLink),e[t].className+=" sjs-bound"},_getPath:function(){o._config&&"undefined"!=typeof o._config.mode&&"history"===o._config.mode?o._currentRoute=location.pathname:o._currentRoute=location.hash.replace("#","").trim(),""===o._currentRoute&&(o._currentRoute="/")},_runController:function(e){o._changeView(e),"undefined"!=typeof e.controller&&e.controller()},_findRouteMatch:function(){for(var e=o._currentRoute.split("/").filter(function(e){return""!==e}),t=0;o._routes.length>t;t++){for(var n=o._routes[t],r=n.path.split("/").filter(function(e){return""!==e}),i=0,a=0;r.length>a;a++)"undefined"!=typeof r[a]&&"undefined"!=typeof e[a]&&r[a]===e[a]&&i++,"undefined"!=typeof r[a]&&"*"===r[a]&&i++;if(0!==i&&i===e.length&&e[0]===r[0]){o._doTheRoute(n);break}if(n.path&&n.path===o._currentRoute){o._doTheRoute(n);break}}},goto:function(e){e&&""!==e&&o._changeRoute(e)},_changeRoute:function(e){for(var t=0;o._routes.length>t;t++){var n=o._routes[t];if(n.path&&n.path!==o._currentRoute&&n.name&&n.name===e){o._doTheRoute(n),o._currentRoute=e;break}}},_changeView:function(e){var t=""===o._defaultView?n.get("sjs-view"):o._defaultView;o._defaultView=t,o._altView&&""!==o._altView&&(t=n.get("#"+o._altView)),""!==t&&(e.view&&""!==e.view?(t=n.get("#"+e.view),t&&(t.innerHTML=e.template)):t.innerHTML=e.template,o._bindAllLinks())},_doTheRoute:function(e){e.templateUrl&&("undefined"==typeof e.template||e.template&&""===e.template)?r.get(e.templateUrl).then(function(t){e.template=t,o._runController(e)}):o._runController(e)}};return{elm:n,xhr:r,router:o}}();