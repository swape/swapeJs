var sjs=function(){"use strict";function e(e,t){var n=e.split(" ").length,r=e.charAt(0);return"#"===r&&1===n?document.getElementById(e.replace("#","")):t?document.querySelectorAll(e):document.querySelector(e)}function t(t,n,r){if(!n)return!1;var o=e(t,!0);if(o&&"undefined"!=typeof o&&o.length>0){for(var s=0;s<o.length;s++)o[s]&&o[s][n]&&(r?o[s][n]=o[s][n].replace(r,"").trim():(o[s][n]=null,o[s].removeAttribute(n)));return o}}function n(t,n,r){if(!n||!r)return!1;var o="object"==typeof t?t:e(t,!0);if(o&&"undefined"!=typeof o&&o.length>0){for(var s=0;s<o.length;s++)o[s]&&(o[s][n]?"class"===n?o[s].className=r:o[s][n]=o[s][n]+" "+r:"class"===n?o.className=r:o.attr=r);return o}}function r(t,n,r){var o=e(t,!0);if(!o||"undefined"==typeof o)return!1;if(n){if(o&&o.length>0)for(var s=0;s<o.length;s++)o[s]&&("class"===n?o[s].className=r:o[s][n]=r);else"class"===n?o.className=r:o.attr=r;return o}}function o(t,n){var r=e(t);if(r)return n&&"undefined"!=typeof r[n]?r[n]:r}function s(t,n){var r=e(t,!0);if(r){if(n){var o=[];if(r.length>0){for(var s=0;s<r.length;s++)r[s]&&n&&r[s]&&"undefined"!=typeof r[s][n]&&""!==r[s][n].trim()&&o.push(r[s][n]);return o.length>0&&o}return!1}return r}}function a(){var e=0;if(y.routes&&y.routes.length>0){for(e=0;y.routes.length>e;e++)y.routes[e].route===y.state&&(u(y.routes[e]),j=!0),y.routes[e]["default"]&&(N=y.routes[e]);j===!1&&N&&u(N)}}function u(e){e.template?(T.innerHTML=e.template,i(e)):e.templateUrl&&(S[e.templateUrl]?(T.innerHTML=S[e.templateUrl],i(e)):g("get",e.templateUrl).then(function(t){T.innerHTML=t,i(e),S[e.templateUrl]=t},function(e){console.log(e)})),p()}function i(e){f(),e.controller&&e.controller()}function l(e,t){return new Promise(function(n,r){var o=[];S[t]?(e.innerHTML=S[t],o=e.querySelectorAll("view [sjs-route]"),v(o)):g("get",t).then(function(r){e.innerHTML=r,S[t]=r,o=e.querySelectorAll("view [sjs-route]"),v(o),n("ok")},function(){r("could not find "+t)})})}function f(){for(var e=s("view [sjs-include]"),t="",n=0;e.length>n;n++)t=e[n].getAttribute("sjs-include"),t&&t.length>0&&l(e[n],t)}function c(e){y.hash=e||location.hash,""!==y.hash&&(y.hash=y.hash.replace(y.startHashSign,"").replace("#",""),y.hash=y.hash.split("/"),y.hash.length>0&&(y.state=y.hash[0]))}function h(e){c(e),location.hash=e}function d(e){e.target.attributes["sjs-route"]&&e.target.attributes["sjs-route"].value&&(e.preventDefault(),y.state=e.target.attributes["sjs-route"].value,h(y.state),a())}function v(e){for(H=0;e.length>H;H++)e[H].addEventListener("click",d)}function p(){t("[sjs-route]","className","active");var e=o('[sjs-route="'+y.hash[0]+'"]');e.className=e.className?e.className+" active":"active"}function g(e,t,n,r){return new Promise(function(o,s){var a=new XMLHttpRequest;if(e=e.toUpperCase(),"POST"!==e){var u,i=[];if("undefined"!=typeof n&&null!==n){t=t.match(/\?/gim)?t+"&":t+"?";for(u in n)i.push(encodeURIComponent(u)+"="+encodeURIComponent(n[u]));t+=i.join("&")}}if(a.open(e,t),"undefined"!=typeof r){var l="";for(l in r)a.setRequestHeader(l,r[l])}a.onload=function(){200===a.status?o(a.response):s(Error(a.statusText))},a.onerror=function(){s(Error("Network Error"))},"POST"===e?"undefined"!=typeof n&&null!==n&&a.send(JSON.stringify(n)):a.send()})}function m(e){h(e),a()}var y={routes:[],state:"",hash:"",startHashSign:"#/"},j=!1,N=!1,S={},H=0;c();var w=s("[sjs-route]"),T=o("view");return v(w),{init:function(){a()},objRoutes:y,gotoState:m,get:o,getAll:s,set:r,add:n,remove:t,xhr:g}}();