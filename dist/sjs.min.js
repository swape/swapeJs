"use strict";var sjs=function(){function e(e,t){for(var n=[],o=0;e.length>o;o++)e[o]!==t&&n.push(e[o]);return n}function t(t){return t&&"undefined"!=typeof t&&(t.setStyle=function(e,n){if("undefined"!=typeof t.length)for(var o=0;t.length>o;o++)t[o].style[e]=n;else t.style[e]=n;return t},t.setClass=function(e){if("undefined"!=typeof t.length)for(var n=0;t.length>n;n++)t[n].className=e;else t.className=e;return t},t.addClass=function(e){if("undefined"!=typeof t.length)for(var n=0;t.length>n;n++)t[n].className=t[n].className+" "+e;else t.className=t.className+" "+e;return t},t.removeClass=function(n){if("undefined"!=typeof t.length){for(var o=0;t.length>o;o++)if(t[o].classList.length>0){var r=e(t[o].classList,n);t[o].className=r.join(" ")}}else if(t.classList.length>0){var i=e(t.classList,n);t.className=i.join(" ")}return t}),t}var n={get:function(e,n){var o=e.trim().split(" ").length,r=e.charAt(0),i=null;return i="#"===r&&1===o?document.getElementById(e.replace("#","")):n?document.querySelectorAll(e):document.querySelector(e),i=t(i)},getAll:function(e){return n.get(e,!0)}},o={xhr:function(e,t,n,o){return new Promise(function(r,i){var a=new XMLHttpRequest;if(e=e.toUpperCase(),"POST"!==e){var u=[],l=void 0;if("undefined"!=typeof n&&null!==n){t=t.match(/\?/gim)?t+"&":t+"?";for(l in n)u.push(encodeURIComponent(l)+"="+encodeURIComponent(n[l]));t+=u.join("&")}}if(a.open(e,t),o&&"undefined"!=typeof o){var s="";for(s in o)a.setRequestHeader(s,o[s])}a.onload=function(){200===a.status?r(a.response):i(Error(a.statusText))},a.onerror=function(){i(Error("Network Error"))},"POST"===e?"undefined"!=typeof n&&null!==n&&a.send(JSON.stringify(n)):a.send()})},get:function(e,t,n){return o.xhr("GET",e,t,n)},post:function(e,t,n){return o.xhr("POST",e,t,n)}},r={_routes:[],_currentRoute:"",_defaultView:"",_config:{},_altView:"",add:function(e){return r._routes.push(e),r},init:function(e){return r._config=e,r._bindAllLinks(),r._getPath(),r._findRouteMatch(),r._markActiveLink(),r._historyChange(),r},_historyChange:function(){window.onhashchange=function(){r._getPath(),r._findRouteMatch()},window.onpopstate=function(){r._getPath(),r._findRouteMatch()}},_markActiveLink:function(){var e=n.get("a[sjs-link]",!0);if(e&&e.length>0)for(var t=0;e.length>t;t++){var o=e[t];r._currentRoute===o.pathname&&r._makeActiveLink(o)}},_bindAllLinks:function(){r._bindLinks(n.get("a[sjs-link]:not(.sjs-bound)",!0))},_bindLink:function(e){if(e.preventDefault(),e.stopPropagation(),r._currentRoute!==e.target.pathname){if(r._config&&"undefined"!=typeof r._config.mode&&"history"===r._config.mode){var t=e.target.innerText.trim().replace(/ /gi,"_");window.history.pushState(null,t,e.target.pathname)}else location.hash=e.target.pathname;r._getPath(),r._altView=e.target.getAttribute("sjs-link"),r._findRouteMatch(),r._markActiveLink()}},_makeActiveLink:function(e){n.get("a[sjs-link]",!0).removeClass("active"),e.className=e.className+" active"},_bindLinks:function(e){if(e&&e.length>0)for(var t=0;e.length>t;t++)e[t].addEventListener("click",r._bindLink),e[t].className+=" sjs-bound"},_getPath:function(){r._config&&"undefined"!=typeof r._config.mode&&"history"===r._config.mode?r._currentRoute=location.pathname:r._currentRoute=location.hash.replace("#","").trim(),""===r._currentRoute&&(r._currentRoute="/")},_runController:function(e){r._changeView(e),"undefined"!=typeof e.controller&&e.controller()},_findRouteMatch:function(){for(var e=r._currentRoute.split("/").filter(function(e){return""!==e}),t=0;r._routes.length>t;t++){for(var n=r._routes[t],o=n.path.split("/").filter(function(e){return""!==e}),i=0,a=0;o.length>a;a++)"undefined"!=typeof o[a]&&"undefined"!=typeof e[a]&&o[a]===e[a]&&i++,"undefined"!=typeof o[a]&&"*"===o[a]&&i++;if(n.path&&n.path===r._currentRoute){r._doTheRoute(n);break}if(0!==i&&i===e.length&&e[0]===o[0]){r._doTheRoute(n);break}}},goto:function(e){e&&""!==e&&r._changeRoute(e)},_changeRoute:function(e){for(var t=0;r._routes.length>t;t++){var n=r._routes[t];if(n.path&&n.path!==r._currentRoute&&n.name&&n.name===e){r._doTheRoute(n),r._currentRoute=e;break}}},_changeView:function(e){var t=""===r._defaultView?n.get("sjs-view"):r._defaultView;r._defaultView=t,r._altView&&""!==r._altView&&(t=n.get("#"+r._altView)),""!==t&&(e.view&&""!==e.view?(t=n.get("#"+e.view),t&&(t.innerHTML=e.template)):t.innerHTML=e.template,r._bindAllLinks())},_doTheRoute:function(e){e.templateUrl&&("undefined"==typeof e.template||e.template&&""===e.template)?o.get(e.templateUrl).then(function(t){e.template=t,r._runController(e)}):r._runController(e)}};return{elm:n,xhr:o,router:r}}();